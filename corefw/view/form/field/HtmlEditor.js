// Generated by CoffeeScript 1.8.0
Ext.define('Corefw.view.form.field.HtmlEditor', {
  extend: 'Ext.form.field.HtmlEditor',
  xtype: 'corehtmleditor',
  initFrameDoc: function() {
    var doc, me, task;
    me = this;
    if (Ext.isIE) {
      me.callParent(arguments);
      return;
    }
    Ext.TaskManager.stop(me.monitorTask);
    doc = me.getDoc();
    me.win = me.getWin();
    me.iframeEl.el.dom.src = "javascript:''";
    doc.open();
    doc.write(me.getDocMarkup());
    doc.close();
    task = {
      run: function() {
        doc = me.getDoc();
        if (doc.body || doc.readyState === 'complete') {
          Ext.TaskManager.stop(task);
          me.setDesignMode(true);
          return Ext.defer(me.initEditor, 10, me);
        }
      },
      interval: 10,
      duration: 10000,
      scope: me
    };
    Ext.TaskManager.start(task);
  },
  setValue: function(val) {
    var value;
    val || (val = '');
    try {
      value = decodeURI(val);
    } catch (_error) {
      value = val;
    }
    return this.callParent([value]);
  },
  getValue: function() {
    return encodeURI(this.callParent(arguments));
  }
});
